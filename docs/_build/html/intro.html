<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; Buffalo 1.2.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Algorithms" href="algo.html" />
    <link rel="prev" title="Welcome to Buffalo’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Buffalo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#from-source-code">From source code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database">Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hyper-paremter-optimization">Hyper paremter Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logging">Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algo.html"> Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallels.html"> Parallels</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kakao/buffalo/tree/master/benchmark"> Benchmarks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Buffalo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/intro.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h1>
<p>Buffalo is a fast and scalable production-ready open source project for recommendation systems. Buffalo effectively utilizes system resources, enabling high performance even on low-spec machines. The implementation is optimized for CPU and SSD. Even so, it shows good performance with GPU accelerator, too. Buffalo, developed by Kakao, has been reliably used in production for various Kakao services.</p>
<p>Buffalo provides the following algorithms:</p>
<blockquote>
<div><ul class="simple">
<li><p>Alternating Least Squares (ALS)</p></li>
<li><p>Bayesian Personalized Ranking Matrix Factorization (BPR)</p></li>
<li><p>Word2Vec (W2V)</p></li>
<li><p>CoFactors (CFR)</p></li>
<li><p>Weighted Approximate Rank Pairwise (WARP)</p></li>
<li><p>Probabilistic latent semantic indexing (pLSI)</p></li>
</ul>
</div></blockquote>
<p>ALS is one of the most famous matrix factorization models which decompose the observed user-item interaction matrix into user and item latent factors. One disitnguishing feature of the implementation of Buffalo ALS is that we offer both GPU based optimization and recently proposed [Block Coordinate Least Squares](<a class="reference external" href="https://arxiv.org/abs/2110.14044">https://arxiv.org/abs/2110.14044</a>) which enable blazingly fast model training. More ranking optimized models are BPR and WARP. W2V and CFR mainly focus on the item co-occurrence data. Unlike other models, pLSI (a.k.a probabilistic latent semantic analysis) is a soft clustering module that performs a low-rank approximation of user-item matrix on the basis of their frequencies.</p>
<p>All algorithms are optimized for multi-threading and some support GPU accelerators.</p>
<p>One of the best things about this library is a very low memory usage compared to other competing libraries. With chunked data management and batch learning with HDF5, handling a large-scale data, even bigger than memory size on laptop machine, is made possible. Check out the benchmarks page for more details on Buffalo performance.</p>
<p>Plus, Buffalo provides a variety of convenient features for research and production purposes, such as tensorboard integration, hyper-parameter optimization and so on.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>Type <cite>pip install buffalo</cite>.</p>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading"></a></h3>
<blockquote>
<div><ul class="simple">
<li><p>numpy</p></li>
<li><p>cython</p></li>
<li><p>n2</p></li>
<li><p>cmake</p></li>
</ul>
</div></blockquote>
</section>
<section id="from-source-code">
<h3>From source code<a class="headerlink" href="#from-source-code" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$&gt; git clone -b master https://github.com/kakao/buffalo
$&gt; <span class="nb">cd</span> buffalo
$&gt; git submodule update --init
$&gt; pip install -r requirements.txt
$&gt; python setup.py install
</pre></div>
</div>
</section>
</section>
<section id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this heading"></a></h2>
<p>We highly recommend starting with the unit-test codes. Checkout ./tests directory, <cite>./tests/algo/test_algo.py</cite> will be a good starting point.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ buffalo.git/tests&gt; nosetests ./algo/test_als.py -v
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ buffalo.git/tests&gt; pytest ./algo/test_als.py -v
</pre></div>
</div>
</section>
<section id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this heading"></a></h2>
<p>We call term <cite>database</cite> as a data file format used by the buffalo internally. Buffalo take data that the Matrix Market or Stream format as input and converts it into a database class which store rawdata using h5py(<a class="reference external" href="http://www.h5py.org">http://www.h5py.org</a>). The main reason to make custom database is to use the least amount of memory without compromising capacity of data volumn and learning speed.</p>
<p>The Stream data format consists of two files:</p>
<blockquote>
<div><ul class="simple">
<li><p>main</p>
<ul>
<li><p>Assumed that the data is reading history of users from some blog service, then each line is a reading history corresponding to each row of UID files. (i.e. users lists)</p></li>
<li><p>The reading history is seperated by spaces, and the past is the left and the right is the most recent history.</p></li>
<li><p>e.g. <cite>A B C D D E</cite> means that a user read the contents in the order A B C D D E.</p></li>
</ul>
</li>
<li><p>uid</p>
<ul>
<li><p>Each line is repersentational value of a user corresponding to each row in the MAIN file (e.g. user name)</p></li>
<li><p>Do not allow spaces in each line</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p>For Matrix Market format, please refer to <a class="reference external" href="https://math.nist.gov/MatrixMarket/formats.html">https://math.nist.gov/MatrixMarket/formats.html</a>.</p>
<blockquote>
<div><ul class="simple">
<li><p>main</p>
<ul>
<li><p>Matrix Market data file.</p></li>
</ul>
</li>
<li><p>uid</p>
<ul>
<li><p>Each line is the actual userkey corresponding to the row id in the MM file.</p></li>
</ul>
</li>
<li><p>iid</p>
<ul>
<li><p>Each line is the actual itemkey corresponding to the colum id in the MM file.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p>uid and iid are the data needed to provide human readable results only, not required.</p>
</section>
<section id="hyper-paremter-optimization">
<h2>Hyper paremter Optimization<a class="headerlink" href="#hyper-paremter-optimization" title="Permalink to this heading"></a></h2>
<p>The Algo classes inherited Optimizable class, a helper class for hyper parameter optimization. It inherits all features from hyperopt(<a class="reference external" href="http://hyperopt.github.io/hyperopt/">http://hyperopt.github.io/hyperopt/</a>), a well-known library.</p>
<p>The options for optimization should be stored in optimize field in Algo option. The following is a list of possible options. You can find the practical example from the unittests.</p>
<ul class="simple">
<li><p>loss(str): Target loss to optimize.</p></li>
<li><p>max_trials(int, option): Maximum experiments for optimization. If not given, run forever.</p></li>
<li><p>min_trials(int, option): Minimum experiments before deploying model. (Since the best parameter may not be found after min_trials, the first best parameter is always deployed)</p></li>
<li><p>deployment(bool): Set True to train model with the best parameter. During the optimization, it dumps the model which beats the previous best loss.</p></li>
<li><p>start_with_default_parameters(bool): If set to True, the loss value of the default parameter is used as the starting loss to beat.</p></li>
<li><p>space(dict): Parameter space definition. For more information, please reference hyperopt documentation.</p>
<ul>
<li><p>Note) Since hyperopt’s randint does not support lower value, we changed the implementation. Please check optimize.py.</p></li>
</ul>
</li>
</ul>
</section>
<section id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Permalink to this heading"></a></h2>
<p>It is recommend to use the log library of buffalo for consistent log format.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">buffalo.misc</span> <span class="kn">import</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">,</span> <span class="n">log</span><span class="o">.</span><span class="n">WARN</span><span class="p">,</span> <span class="n">log</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">log</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">log</span><span class="o">.</span><span class="n">TRACE</span><span class="p">)</span>
<span class="go">(0, 1, 2, 3, 4, 5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>  <span class="c1"># this set log-level on Python, C++ both sides.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">get_log_level</span><span class="p">()</span>
<span class="go">1</span>
<span class="go">&gt;&gt;&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">buffalo.misc</span> <span class="kn">import</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">log</span><span class="o">.</span><span class="n">pbar</span><span class="p">(</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="n">mininterval</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="go">    for(i in range(100)):</span>
<span class="go">        time.sleep(0.1)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Buffalo’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="algo.html" class="btn btn-neutral float-right" title="Algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Kakao Corp..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>